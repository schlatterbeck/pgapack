#include "optimize.h"
#include <stdio.h>

#define NOBJ  3
#define DIM  12

static double g (double *x, int k)
{
    int i;
    double s = 0;
    for (i=0; i<k; i++) {
        s += pow (x [i] - 0.5, 2);
    }
    return s;
}

static void f (double *x, int nx, double *y, int ny)
{
    int i, j;
    int k = nx - ny + 1;
    double gv;
    assert (k > 0);
    gv = g (x + nx - k, k);
    for (i=0; i<ny; i++) {
        double p = 1;
        for (j=0; j<ny-i-1; j++) {
            p *= cos (x [j] * M_PI / 2.0);
        }
        if (j < ny-1) {
            p *= sin (x [j] * M_PI / 2.0);
        }
        y [i] = p * (1 + gv);
    }
}

struct multi_problem dtlz2 =
{ .dimension      = DIM
, .n_obj          = NOBJ
, .nconstraint    = 0
, .lower          = 0
, .upper          = 1
, .popsize        = 0
, .generations    = 250
, .f              = f
, .name           = "DTLZ2"
};

#ifdef DEBUG_EVAL
#include <stdio.h>
#define K (DIM - NOBJ + 1)
int main ()
{
    int i, j;
    static double xx [][DIM] =
        { { 0.7990713, 0.9987567, 0.4999981, 0.5000016, 0.5000002, 0.5000007
          , 0.5000039, 0.4999985, 0.5, 0.4999988, 0.4999991, 0.5000001
          }
        , { 0.8768066, 0.002213867, 0.5000014, 0.5000008, 0.5000017, 0.5000025
          , 0.5000011, 0.5000013, 0.5000008, 0.4999968, 0.4999977, 0.5000004
          }
        , { 0.002116579, 0.6097939, 0.4999965, 0.4999996, 0.4999975, 0.5000001
          , 0.4999977, 0.5000076, 0.5000005, 0.4999963, 0.4999986, 0.5000006
          }
        , { 0.942948, 0.9999888, 0.4999946, 0.4999998, 0.5, 0.4999966
          , 0.5000006, 0.4999996, 0.5, 0.5000004, 0.5000003, 0.4999978
          }
        , { 0.3869682, 0.3446546, 0.4999983, 0.4999998, 0.5000027, 0.5000006
          , 0.500001, 0.4999997, 0.4999977, 0.5000014, 0.5000031, 0.4999993
          }
        , { 0.6129585, 0.996667, 0.5000018, 0.4999998, 0.5000004, 0.4999936
          , 0.4999996, 0.5000004, 0.5000011, 0.500003, 0.5000029, 0.4999995
          }
        , { 0.7532935, 0.7929398, 0.4999947, 0.5000014, 0.5, 0.4999982
          , 0.499997, 0.500008, 0.4999993, 0.5000135, 0.4999993, 0.5000001
          }
        , { 0.5922132, 0.7044486, 0.5, 0.5000005, 0.4999998, 0.5000003
          , 0.4999978, 0.4999968, 0.5000005, 0.4999981, 0.5000031, 0.4999995
          }
        , { 0.3363782, 0.9114713, 0.499994, 0.4999992, 0.5000003, 0.4999969
          , 0.5000018, 0.5000019, 0.499996, 0.4999999, 0.4999986, 0.5000003
          }
        , { 0.1336786, 0.9234562, 0.4999984, 0.5, 0.5000009, 0.5
          , 0.4999997, 0.4999867, 0.4999995, 0.5000005, 0.4999873, 0.500001
          }
        , { 0.499977, 0.4120984, 0.5000031, 0.4999998, 0.5, 0.4999993
          , 0.499999, 0.5000007, 0.5, 0.4999975, 0.5000009, 0.5000004
          }
        , { 0.1261069, 0.9990711, 0.49998, 0.5000003, 0.5000022, 0.5000001
          , 0.5000002, 0.5000029, 0.5000005, 0.5000061, 0.4999997, 0.5000013
          }
        , { 0.5491108, 0.1163625, 0.5000022, 0.5000004, 0.5000001, 0.500001
          , 0.4999968, 0.4999994, 0.5000018, 0.4999995, 0.4999965, 0.5000012
          }
        , { 0.06066654, 0.9999698, 0.4999982, 0.5000004, 0.4999996, 0.4999949
          , 0.5000022, 0.5000164, 0.4999989, 0.5000015, 0.4999874, 0.4999993
          }
        , { 0.4322615, 0.9114713, 0.4999982, 0.4999992, 0.4999829, 0.5000029
          , 0.4999962, 0.4999988, 0.5, 0.4999982, 0.4999999, 0.499999
          }
        , { 0.7990713, 0.9998206, 0.5000157, 0.4999997, 0.5000006, 0.5000028
          , 0.5000006, 0.5000024, 0.5000017, 0.5000059, 0.4999996, 0.5000009
          }
        , { 0.347866, 0.208454, 0.5000005, 0.5000009, 0.5000098, 0.5000015
          , 0.5000017, 0.5000035, 0.5000017, 0.4999998, 0.4999954, 0.4999993
          }
        , { 0.1620924, 0.7455117, 0.5000166, 0.4999989, 0.4999999, 0.4999975
          , 0.4999999, 0.5000036, 0.5, 0.5000006, 0.4999996, 0.5000003
          }
        , { 0.9956566, 0.9995554, 0.4999972, 0.4999995, 0.500002, 0.5000039
          , 0.5000006, 0.4999958, 0.5000002, 0.4999953, 0.4999995, 0.499999
          }
        , { 0.1475865, 0.83649, 0.4999981, 0.4999991, 0.5000005, 0.5000176
          , 0.4999979, 0.500006, 0.5000013, 0.4999988, 0.4999892, 0.4999997
          }
        , { 0.7532935, 0.2138451, 0.4999926, 0.4999999, 0.4999998, 0.5000014
          , 0.499997, 0.5, 0.4999982, 0.5000098, 0.4999982, 0.4999998
          }
        , { 0.001442809, 0.3938227, 0.5000012, 0.5000014, 0.5000001, 0.4999995
          , 0.5000008, 0.4999974, 0.5000028, 0.499996, 0.5000039, 0.5000006
          }
        , { 0.2763849, 0.700316, 0.4999998, 0.4999995, 0.5000003, 0.4999987
          , 0.4999983, 0.4999968, 0.4999973, 0.5000199, 0.4999983, 0.5000004
          }
        , { 0.08300301, 0.2286695, 0.4999973, 0.4999975, 0.4999993, 0.4999977
          , 0.5000017, 0.499999, 0.499999, 0.5000132, 0.4999997, 0.4999994
          }
        , { 0.3948696, 0.6482102, 0.4999994, 0.5000007, 0.5000097, 0.5000003
          , 0.4999991, 0.5000177, 0.4999998, 0.4999939, 0.4999965, 0.5000009
          }
        , { 0.06058188, 0.000357008, 0.5000031, 0.5000007, 0.5000001, 0.5000059
          , 0.4999989, 0.4999959, 0.5000006, 0.5000029, 0.4999961, 0.4999996
          }
        , { 0.5053955, 0.9999596, 0.4999933, 0.5000006, 0.5000014, 0.4999971
          , 0.4999964, 0.4999994, 0.5000011, 0.4999966, 0.5000012, 0.4999998
          }
        , { 0.2048127, 0.0006596867, 0.4999992, 0.4999999, 0.5000017, 0.4999974
          , 0.5000042, 0.4999981, 0.4999997, 0.5000015, 0.4999998, 0.4999997
          }
        , { 0.0004454092, 0.4971486, 0.4999873, 0.5, 0.5000004, 0.5000042
          , 0.5000011, 0.5000081, 0.5000018, 0.500001, 0.5000049, 0.5000013
          }
        , { 0.2928819, 0.4393257, 0.5000336, 0.5000002, 0.5000019, 0.5000001
          , 0.4999986, 0.5000017, 0.5000011, 0.5000005, 0.5000016, 0.4999993
          }
        , { 0.8456059, 0.6998815, 0.500002, 0.5000003, 0.4999999, 0.5000011
          , 0.4999996, 0.5000004, 0.5000013, 0.5000079, 0.4999998, 0.5000015
          }
        , { 0.1336786, 0.06587951, 0.4999984, 0.5, 0.5000009, 0.5
          , 0.4999975, 0.4999867, 0.4999989, 0.5000005, 0.4999971, 0.500001
          }
        , { 0.8467681, 0.3033827, 0.4999933, 0.5000001, 0.5000001, 0.4999998
          , 0.4999998, 0.500001, 0.4999997, 0.5000001, 0.5000028, 0.4999992
          }
        , { 0.6044572, 0.000357008, 0.500009, 0.5000017, 0.5, 0.5000007
          , 0.4999993, 0.5000085, 0.5000008, 0.4999919, 0.4999985, 0.4999983
          }
        , { 0.39402, 0.0004808312, 0.4999972, 0.5, 0.5000002, 0.5000008
          , 0.4999977, 0.5000038, 0.4999983, 0.499999, 0.4999994, 0.4999995
          }
        , { 0.7013596, 0.3871738, 0.5000008, 0.5000002, 0.4999998, 0.5000003
          , 0.4999977, 0.5000008, 0.4999953, 0.4999967, 0.5000003, 0.4999998
          }
        , { 4.361998e-06, 0.9997903, 0.4999935, 0.5000017, 0.5, 0.4999965
          , 0.4999995, 0.4999913, 0.4999971, 0.5000049, 0.5000016, 0.4999998
          }
        , { 0.228996, 0.07913732, 0.4999957, 0.5, 0.5000013, 0.5000035
          , 0.4999996, 0.5000285, 0.5000016, 0.499997, 0.4999998, 0.4999998
          }
        , { 0.2763849, 0.5580022, 0.4999998, 0.5000001, 0.5000003, 0.5000021
          , 0.4999983, 0.5000062, 0.5000048, 0.5000199, 0.4999983, 0.4999983
          }
        , { 0.1247494, 0.002853411, 0.4999957, 0.5000003, 0.4999996, 0.4999976
          , 0.5000126, 0.5000033, 0.5000006, 0.4999966, 0.5000001, 0.4999988
          }
        , { 0.08139408, 0.7824559, 0.4999948, 0.5000001, 0.5000109, 0.5000001
          , 0.4999996, 0.5000006, 0.5000005, 0.4999978, 0.5000019, 0.5000018
          }
        , { 0.4960607, 0.5713447, 0.4999927, 0.5000001, 0.4999994, 0.4999964
          , 0.4999978, 0.4999946, 0.5000004, 0.5000108, 0.5000019, 0.5000005
          }
        , { 0.0001597018, 0.7044486, 0.5, 0.5000005, 0.5000005, 0.5000003
          , 0.5000025, 0.4999968, 0.5000015, 0.5000007, 0.4999861, 0.5000002
          }
        , { 0.3962528, 0.9999969, 0.499987, 0.4999994, 0.5000002, 0.5000009
          , 0.500004, 0.499999, 0.5000001, 0.4999994, 0.5000008, 0.4999991
          }
        , { 0.1550484, 0.1524061, 0.5000036, 0.4999991, 0.5000001, 0.4999999
          , 0.4999991, 0.4999754, 0.4999996, 0.4999953, 0.5000019, 0.4999971
          }
        , { 0.4692077, 0.2548212, 0.499994, 0.5000001, 0.5000001, 0.4999957
          , 0.5000069, 0.5000005, 0.5, 0.4999953, 0.5000018, 0.4999982
          }
        , { 0.6926049, 0.6097939, 0.5000066, 0.4999973, 0.5000015, 0.4999998
          , 0.5000014, 0.5000033, 0.5000017, 0.4999957, 0.4999988, 0.4999998
          }
        , { 0.001442809, 0.05916092, 0.4999995, 0.5000008, 0.5000017, 0.4999579
          , 0.4999631, 0.5000013, 0.4999998, 0.5000037, 0.5, 0.5000074
          }
        , { 0.3963474, 0.999969, 0.5000007, 0.4999998, 0.4999999, 0.500005
          , 0.4999988, 0.5000076, 0.5000051, 0.499996, 0.4999994, 0.5000021
          }
        , { 0.7081906, 0.9999888, 0.4999857, 0.5000012, 0.5000001, 0.5000007
          , 0.5000012, 0.4999966, 0.4999996, 0.4999982, 0.5000016, 0.4999996
          }
        , { 0.4412642, 0.1163625, 0.5000022, 0.5000006, 0.5000003, 0.500001
          , 0.499998, 0.5000012, 0.499997, 0.4999995, 0.4999999, 0.5000004
          }
        , { 0.5996878, 0.3033827, 0.5000001, 0.4999999, 0.5, 0.5000004
          , 0.4999988, 0.5000019, 0.4999995, 0.499998, 0.5000021, 0.4999994
          }
        , { 0.08139408, 0.6685201, 0.4999972, 0.5000001, 0.4999991, 0.5000015
          , 0.4999996, 0.5000016, 0.5000005, 0.4999978, 0.5000019, 0.4999998
          }
        , { 0.08501112, 0.4536646, 0.5000049, 0.4999989, 0.4999996, 0.5000192
          , 0.4999977, 0.5000148, 0.5000008, 0.5000026, 0.4999998, 0.5000001
          }
        , { 0.7057073, 0.002213867, 0.5000014, 0.5000008, 0.4999992, 0.5000052
          , 0.5000027, 0.5000013, 0.5000008, 0.500001, 0.4999977, 0.5000004
          }
        , { 0.9411702, 0.9863636, 0.500002, 0.4999998, 0.5000002, 0.499999
          , 0.4999997, 0.499999, 0.5000018, 0.4999985, 0.4999968, 0.4999992
          }
        , { 0.330486, 0.09353846, 0.4999923, 0.5000002, 0.5, 0.5000012
          , 0.5000032, 0.4999975, 0.5000006, 0.4999942, 0.4999978, 0.4999996
          }
        , { 0.5588291, 0.872405, 0.5000023, 0.4999981, 0.4999992, 0.4999937
          , 0.4999987, 0.5000107, 0.4999996, 0.5000015, 0.500001, 0.5000028
          }
        , { 0.7090531, 0.9997112, 0.5000005, 0.5000003, 0.5000019, 0.5000046
          , 0.5000002, 0.50001, 0.5000004, 0.5000035, 0.5000027, 0.4999999
          }
        , { 0.1550484, 0.2548212, 0.499994, 0.4999998, 0.5000001, 0.4999957
          , 0.4999984, 0.5000005, 0.5, 0.4999953, 0.5000018, 0.4999999
          }
        , { 0.6034916, 0.506953, 0.4999975, 0.4999993, 0.4999999, 0.5000029
          , 0.4999974, 0.5000031, 0.4999997, 0.4999969, 0.5000004, 0.4999985
          }
        , { 0.06268645, 0.8588125, 0.5000036, 0.5000003, 0.5000006, 0.4999997
          , 0.4999982, 0.5000023, 0.500001, 0.5000067, 0.5000005, 0.5000007
          }
        , { 0.2500806, 0.3032269, 0.5000015, 0.5000001, 0.4999995, 0.5000016
          , 0.5000024, 0.4999999, 0.5000002, 0.5000027, 0.5000003, 0.5
          }
        , { 0.2986046, 0.0002751392, 0.4999941, 0.4999997, 0.5, 0.4999984
          , 0.5000059, 0.4999952, 0.5000035, 0.4999982, 0.4999999, 0.4999987
          }
        , { 0.1758, 0.4959949, 0.5000039, 0.5000001, 0.5000005, 0.4999978
          , 0.5000021, 0.500001, 0.4999998, 0.5000038, 0.5000186, 0.4999994
          }
        , { 0.9469249, 0.0006596867, 0.4999992, 0.5000002, 0.4999995, 0.500002
          , 0.4999972, 0.5000054, 0.5000016, 0.5000035, 0.5000045, 0.5000004
          }
        , { 4.678356e-05, 0.202922, 0.4999982, 0.5000003, 0.5000002, 0.499996
          , 0.5000015, 0.5000053, 0.4999985, 0.4999987, 0.4999984, 0.5000017
          }
        , { 0.6714979, 0.1652268, 0.4999983, 0.500001, 0.4999958, 0.500001
          , 0.5000011, 0.5000028, 0.5000015, 0.5000024, 0.4999995, 0.4999999
          }
        , { 0.4636726, 0.7568934, 0.5000061, 0.5000004, 0.5000006, 0.4999959
          , 0.5000037, 0.500001, 0.4999994, 0.5000026, 0.499996, 0.5000001
          }
        , { 0.3462539, 0.7871996, 0.500001, 0.4999996, 0.4999953, 0.5000033
          , 0.4999965, 0.4999937, 0.4999968, 0.5000001, 0.5000075, 0.4999999
          }
        , { 0.7873198, 0.4959949, 0.4999933, 0.4999991, 0.5000006, 0.4999993
          , 0.4999969, 0.4999942, 0.5000011, 0.4999969, 0.5000027, 0.4999991
          }
        , { 0.3987186, 0.4959949, 0.5000029, 0.4999989, 0.5, 0.4999978
          , 0.4999969, 0.5000108, 0.4999999, 0.4999989, 0.5000001, 0.4999991
          }
        , { 0.6053302, 0.9998206, 0.5000035, 0.5000032, 0.5000017, 0.5000028
          , 0.5000006, 0.5000024, 0.5000017, 0.4999968, 0.4999984, 0.5000009
          }
        , { 0.2374172, 0.178746, 0.4999928, 0.4999999, 0.4999991, 0.4999995
          , 0.5000066, 0.500007, 0.4999991, 0.4999919, 0.5000031, 0.4999998
          }
        , { 0.6585623, 0.8487513, 0.5000079, 0.5000002, 0.4999997, 0.4999995
          , 0.4999998, 0.5000045, 0.5000013, 0.5000054, 0.5000033, 0.4999997
          }
        , { 0.001612141, 0.8019986, 0.5000031, 0.4999998, 0.5000001, 0.5000056
          , 0.5000007, 0.4999932, 0.5000011, 0.5000042, 0.500003, 0.5000006
          }
        , { 0.001612141, 0.8821851, 0.4999959, 0.4999997, 0.5000006, 0.5000008
          , 0.5000007, 0.5000065, 0.5000002, 0.500001, 0.5000059, 0.5000006
          }
        , { 0.8765227, 0.999969, 0.5000275, 0.4999998, 0.4999995, 0.4999998
          , 0.4999979, 0.5000005, 0.4999984, 0.5000038, 0.5000092, 0.5000001
          }
        , { 0.001540181, 0.1233351, 0.50001, 0.5000003, 0.5000002, 0.4999915
          , 0.4999998, 0.5000067, 0.5000007, 0.4999992, 0.5000008, 0.4999992
          }
        , { 0.2928819, 0.996667, 0.5000017, 0.4999994, 0.5000009, 0.4999992
          , 0.4999994, 0.5000064, 0.4999972, 0.499997, 0.5000013, 0.5000006
          }
        , { 0.299644, 0.9999618, 0.5000068, 0.4999997, 0.4999999, 0.5000021
          , 0.5000028, 0.5000056, 0.4999998, 0.4999967, 0.5000038, 0.5000016
          }
        , { 0.8765227, 0.9999844, 0.5000172, 0.4999999, 0.4999997, 0.4999998
          , 0.4999967, 0.5000005, 0.4999984, 0.5000004, 0.5000092, 0.5000001
          }
        , { 0.001389015, 0.0002751392, 0.4999941, 0.5000003, 0.4999989, 0.4999984
          , 0.4999978, 0.4999952, 0.5000035, 0.4999982, 0.4999999, 0.4999987
          }
        , { 0.08501112, 0.3309194, 0.4999986, 0.5, 0.4999999, 0.4999995
          , 0.5000019, 0.4999954, 0.5000028, 0.4999999, 0.499995, 0.5000012
          }
        , { 0.1723486, 0.3654903, 0.4999995, 0.5000003, 0.5, 0.5000007
          , 0.4999997, 0.5000103, 0.4999983, 0.5000066, 0.4999992, 0.4999988
          }
        , { 0.5004523, 0.998649, 0.4999943, 0.4999997, 0.4999997, 0.4999998
          , 0.4999979, 0.5000007, 0.500004, 0.4999991, 0.4999999, 0.5000019
          }
        , { 0.06268645, 0.9440376, 0.5000048, 0.4999996, 0.5, 0.5000015
          , 0.5000013, 0.5000027, 0.5000099, 0.500001, 0.5000005, 0.4999976
          }
        , { 0.228996, 0.9169341, 0.4999957, 0.5, 0.4999984, 0.5000005
          , 0.4999995, 0.5000057, 0.5, 0.4999968, 0.5000044, 0.4999985
          }
        , { 0.9956566, 0.9997399, 0.4999933, 0.5000002, 0.5000003, 0.5000002
          , 0.5000006, 0.4999959, 0.5000003, 0.4999984, 0.5000001, 0.5000001
          }
        , { 0.0004454092, 0.9488802, 0.4999982, 0.4999984, 0.4999991, 0.5000005
          , 0.4999971, 0.4999991, 0.4999998, 0.5000199, 0.5000018, 0.4999992
          }
        , { 0.7928106, 0.00138975, 0.4999926, 0.5000002, 0.4999996, 0.5000003
          , 0.4999991, 0.5000015, 0.4999995, 0.4999996, 0.5000036, 0.5000011
          }
        , { 0.9077905, 0.4817803, 0.4999917, 0.5000001, 0.5000016, 0.5000005
          , 0.4999997, 0.4999991, 0.4999979, 0.5000046, 0.4999954, 0.4999996
          }
        , { 0.08139408, 0.5631396, 0.4999948, 0.5000001, 0.5000109, 0.5000001
          , 0.4999996, 0.5000006, 0.5000005, 0.5, 0.5000019, 0.5000027
          }
        , { 9.318819e-05, 0.2954283, 0.4999987, 0.4999999, 0.4999995, 0.5000005
          , 0.5000011, 0.5000065, 0.5000018, 0.5000124, 0.5000002, 0.5000003
          }
        , { 0.1784669, 0.621778, 0.499977, 0.4999995, 0.4999972, 0.4999983
          , 0.4999984, 0.500001, 0.4999993, 0.4999999, 0.4999949, 0.5000001
          }
        , { 0.08501112, 0.1319708, 0.5000004, 0.5000003, 0.5000003, 0.5000009
          , 0.4999991, 0.499999, 0.5000008, 0.5000026, 0.5000095, 0.5000012
          }
        , { 0.2561241, 0.817542, 0.5000008, 0.4999994, 0.500001, 0.4999994
          , 0.5000006, 0.5000038, 0.5000034, 0.5000154, 0.4999999, 0.4999998
          }
        , { 0.5084922, 0.003003579, 0.5000011, 0.5000002, 0.5000003, 0.5000039
          , 0.4999983, 0.5000008, 0.5000015, 0.4999972, 0.5000003, 0.4999998
          }
        , { 0.06058188, 0.05809076, 0.5000109, 0.5000003, 0.5000018, 0.4999985
          , 0.5000013, 0.4999936, 0.5000002, 0.4999994, 0.5000006, 0.4999996
          }
        , { 0.2107103, 0.9999721, 0.5000363, 0.4999994, 0.5000017, 0.5000002
          , 0.5000007, 0.5000016, 0.5000004, 0.4999997, 0.5000011, 0.5000002
          }
        };
    double yy [NOBJ];
    size_t sz = sizeof (xx) / (sizeof (double) * DIM);
    for (i=0; i<sz; i++) {
        double s = 0;
        f (xx [i], DIM, yy, NOBJ);
        printf ("G: %e\n", g (xx [i] + DIM - K, K));
        for (j=0; j<NOBJ; j++) {
            printf ("F %d %e\n", j, yy [j]);
            s += yy [j];
        }
        printf ("\ns: %e\n", s);
    }
}
#endif /* DEBUG_EVAL */
