#include "optimize.h"
#include <stdio.h>

#define NOBJ  3
#define DIM  12

static double g (double *x, int k)
{
    int i;
    double s = 0;
    for (i=0; i<k; i++) {
        s += pow (x [i] - 0.5, 2);
    }
    return s;
}

static void f (double *x, int nx, double *y, int ny)
{
    int i, j;
    int k = nx - ny + 1;
    double gv;
    assert (k > 0);
    gv = g (x + nx - k, k);
    for (i=0; i<ny; i++) {
        double p = 1;
        for (j=0; j<ny-i-1; j++) {
            p *= cos (x [j] * M_PI / 2.0);
        }
        if (j < ny-1) {
            p *= sin (x [j] * M_PI / 2.0);
        }
        y [i] = pow (p * (1 + gv), (i == ny - 1) ? 2 : 4);
    }
}

struct multi_problem convex_dtlz2 =
{ .dimension      = DIM
, .n_obj          = NOBJ
, .nconstraint    = 0
, .lower          = 0
, .upper          = 1
, .popsize        = 0
, .generations    = 250
, .f              = f
, .name           = "Convex DTLZ2"
};

#ifdef DEBUG_EVAL
#include <stdio.h>
#define K (DIM - NOBJ + 1)
int main ()
{
    int i, j;
    static double xx [][DIM] =
        { { 0.1970556, 0.4341435, 0.5000103, 0.4999991, 0.5000001, 0.5000106
          , 0.4999759, 0.4999984, 0.5000059, 0.4999988, 0.5000003, 0.5000034
          }
        , { 0.2129356, 0.3270843, 0.4999989, 0.5, 0.5000025, 0.5000006
          , 0.4999978, 0.4999992, 0.5000035, 0.5000017, 0.5000005, 0.4999974
          }
        , { 0.1246478, 0.455235, 0.4999977, 0.499995, 0.5000017, 0.5000029
          , 0.500001, 0.5000003, 0.5000019, 0.4999998, 0.5000109, 0.5000074
          }
        , { 0.003934729, 0.3773671, 0.5000014, 0.5000024, 0.5000013, 0.4999993
          , 0.4999985, 0.4999989, 0.5000088, 0.4999894, 0.4999998, 0.5000016
          }
        , { 0.02211511, 0.4459282, 0.4999997, 0.5000016, 0.4999997, 0.5000014
          , 0.5000015, 0.5000004, 0.500002, 0.4999966, 0.5000002, 0.5000021
          }
        , { 0.1562917, 0.6838191, 0.4999955, 0.499998, 0.5000006, 0.5000007
          , 0.5000018, 0.4999998, 0.5000017, 0.5000055, 0.4999991, 0.5000029
          }
        , { 0.6520422, 0.1372407, 0.5000019, 0.5000143, 0.4999998, 0.4999988
          , 0.5000009, 0.4999995, 0.4999746, 0.4999984, 0.5000019, 0.5000073
          }
        , { 0.2012072, 0.6701928, 0.4999996, 0.499991, 0.4999981, 0.5000012
          , 0.5000192, 0.5, 0.5000241, 0.5, 0.499999, 0.5000011
          }
        , { 0.3002857, 0.9979207, 0.4999973, 0.4999762, 0.4999993, 0.5000039
          , 0.4999677, 0.5000002, 0.4999877, 0.4999977, 0.4999967, 0.4999999
          }
        , { 0.6520422, 0.846264, 0.4999928, 0.4999991, 0.5000029, 0.4999998
          , 0.4999942, 0.5000008, 0.5, 0.4999965, 0.4999984, 0.5000048
          }
        , { 0.003700425, 0.5888505, 0.5000049, 0.4999997, 0.499998, 0.4999998
          , 0.4999873, 0.4999993, 0.4999744, 0.5000026, 0.500001, 0.5000009
          }
        , { 0.3487403, 0.5613562, 0.5000035, 0.5000052, 0.4999998, 0.4999979
          , 0.5000442, 0.5000001, 0.5000005, 0.5000007, 0.5000019, 0.5000003
          }
        , { 0.9961024, 0.4612193, 0.5000015, 0.4999833, 0.5000023, 0.5000011
          , 0.4999937, 0.4999984, 0.5000072, 0.4999988, 0.4999977, 0.4999972
          }
        , { 0.497746, 0.9778205, 0.4999988, 0.4999894, 0.4999951, 0.499999
          , 0.4999909, 0.5000001, 0.5000005, 0.5000039, 0.5000012, 0.5000333
          }
        , { 0.3862198, 0.5354807, 0.5000043, 0.500006, 0.4999989, 0.499996
          , 0.5000071, 0.5000003, 0.5000049, 0.5000026, 0.5000022, 0.5000005
          }
        , { 0.3119596, 0.5242996, 0.5000031, 0.5000159, 0.5000026, 0.4999985
          , 0.4999977, 0.4999985, 0.4999997, 0.5000002, 0.499999, 0.4999994
          }
        , { 0.003934729, 0.504313, 0.5000014, 0.4999933, 0.5000012, 0.4999994
          , 0.500001, 0.4999998, 0.4999975, 0.5000018, 0.4999998, 0.5000025
          }
        , { 0.4215073, 0.4997539, 0.5000027, 0.4999908, 0.5000007, 0.4999983
          , 0.500002, 0.5000033, 0.4999991, 0.5000021, 0.5000069, 0.5000041
          }
        , { 0.6520422, 0.9211226, 0.499998, 0.5000122, 0.500004, 0.5000002
          , 0.5000009, 0.5000002, 0.500006, 0.499999, 0.5000012, 0.4999973
          }
        , { 0.4224191, 0.9987766, 0.5000084, 0.5000003, 0.4999993, 0.4999974
          , 0.5000005, 0.5000012, 0.4999926, 0.5000048, 0.4999989, 0.4999993
          }
        , { 0.1970556, 0.5029597, 0.4999966, 0.4999991, 0.5000024, 0.4999985
          , 0.499995, 0.4999984, 0.5000047, 0.4999988, 0.5000003, 0.4999909
          }
        , { 0.1252251, 0.4277233, 0.4999995, 0.5000008, 0.5000063, 0.5
          , 0.5000204, 0.5000002, 0.4999842, 0.5000001, 0.4999995, 0.5000128
          }
        , { 0.566693, 0.2324897, 0.5000009, 0.4999951, 0.5000002, 0.5000001
          , 0.4999991, 0.5000009, 0.4999913, 0.4999985, 0.5000003, 0.4999914
          }
        , { 0.4341216, 0.4164925, 0.4999998, 0.4999976, 0.4999998, 0.4999977
          , 0.4999946, 0.4999958, 0.5000002, 0.4999962, 0.4999977, 0.5000026
          }
        , { 0.1979618, 0.5399178, 0.5000061, 0.5000097, 0.499999, 0.5000013
          , 0.4999912, 0.4999981, 0.4999939, 0.4999915, 0.499998, 0.5000011
          }
        , { 0.003890938, 0.5291674, 0.5000052, 0.4999947, 0.5000009, 0.5000013
          , 0.4999956, 0.5000018, 0.5000082, 0.5000014, 0.5000016, 0.5000071
          }
        , { 0.2834124, 0.5878746, 0.5000038, 0.4999873, 0.4999992, 0.5000013
          , 0.5000048, 0.500001, 0.4999999, 0.5000015, 0.5000024, 0.5000002
          }
        , { 0.1391944, 0.5813503, 0.5000026, 0.4999774, 0.5000029, 0.500002
          , 0.5000069, 0.499999, 0.5000001, 0.4999953, 0.4999984, 0.5000015
          }
        , { 0.5399802, 0.9702425, 0.500008, 0.5000136, 0.5000014, 0.4999999
          , 0.5000011, 0.5000017, 0.5000007, 0.4999981, 0.4999987, 0.4999925
          }
        , { 0.340478, 0.9056555, 0.5000067, 0.5000064, 0.5000005, 0.4999995
          , 0.5000139, 0.5000005, 0.5000011, 0.500001, 0.5000018, 0.4999964
          }
        , { 0.5877299, 0.9861126, 0.5000159, 0.5000112, 0.4999979, 0.5000014
          , 0.5000042, 0.4999996, 0.4999976, 0.5000035, 0.5000002, 0.5000011
          }
        , { 0.2721742, 0.4935627, 0.4999979, 0.5000131, 0.4999991, 0.5000007
          , 0.4999966, 0.5000004, 0.4999998, 0.5000027, 0.4999982, 0.5000058
          }
        , { 0.3791585, 0.1362416, 0.5000022, 0.5000043, 0.500001, 0.500001
          , 0.4999813, 0.5000005, 0.5000121, 0.5000076, 0.5000024, 0.4999981
          }
        , { 0.1252251, 0.5470651, 0.4999993, 0.4999851, 0.4999998, 0.4999969
          , 0.5000075, 0.4999995, 0.499993, 0.5000005, 0.4999994, 0.4999987
          }
        , { 0.2870725, 0.4175966, 0.499997, 0.4999868, 0.4999983, 0.4999991
          , 0.4999994, 0.5000015, 0.5000014, 0.5000009, 0.4999993, 0.4999999
          }
        , { 0.3193991, 0.4277233, 0.4999963, 0.4999932, 0.5000002, 0.499995
          , 0.4999864, 0.5000013, 0.5000049, 0.5000021, 0.5000067, 0.5000002
          }
        , { 0.1391944, 0.5194256, 0.5000026, 0.4999774, 0.5000029, 0.500002
          , 0.5000069, 0.499999, 0.5000001, 0.4999953, 0.4999984, 0.4999932
          }
        , { 0.4519004, 0.1542307, 0.5000009, 0.4999935, 0.4999997, 0.4999999
          , 0.4999997, 0.5000015, 0.4999942, 0.5000004, 0.5000003, 0.4999961
          }
        , { 0.2763308, 0.5399178, 0.4999998, 0.499995, 0.4999983, 0.5000014
          , 0.4999961, 0.5000037, 0.500003, 0.5000002, 0.5000014, 0.4999846
          }
        , { 0.1368622, 0.4938006, 0.5000067, 0.4999994, 0.5000017, 0.5000001
          , 0.5000131, 0.4999984, 0.4999972, 0.4999992, 0.500001, 0.5000012
          }
        , { 0.1709874, 0.1436886, 0.4999973, 0.4999974, 0.499997, 0.5000007
          , 0.5000056, 0.5000005, 0.5000128, 0.5000004, 0.5000015, 0.5000049
          }
        , { 0.24943, 0.04418589, 0.5000016, 0.5000002, 0.5000002, 0.4999861
          , 0.4999904, 0.4999992, 0.5000056, 0.4999949, 0.4999996, 0.4999997
          }
        , { 0.003890938, 0.5589862, 0.4999893, 0.5000167, 0.5000017, 0.4999988
          , 0.4999955, 0.4999919, 0.500012, 0.4999998, 0.4999977, 0.4999979
          }
        , { 0.001715747, 0.02959393, 0.5000001, 0.4999999, 0.5000006, 0.5000031
          , 0.4999978, 0.4999987, 0.5000022, 0.4999998, 0.4999992, 0.4999998
          }
        , { 0.003934729, 0.4737351, 0.500004, 0.5000109, 0.5000012, 0.5000009
          , 0.4999968, 0.5, 0.4999996, 0.5000004, 0.4999989, 0.5000057
          }
        , { 0.1979618, 0.4708846, 0.5000172, 0.5000045, 0.4999965, 0.5000028
          , 0.5000097, 0.5, 0.5000025, 0.4999977, 0.5000002, 0.5
          }
        , { 0.3087819, 0.4849455, 0.5000023, 0.5000259, 0.5000014, 0.4999951
          , 0.4999936, 0.5000005, 0.5000044, 0.4999978, 0.5000008, 0.5000002
          }
        , { 0.1391944, 0.6195901, 0.5000002, 0.5000059, 0.4999981, 0.5000097
          , 0.4999972, 0.4999999, 0.4999995, 0.5000012, 0.5000089, 0.4999992
          }
        , { 0.2675162, 0.462803, 0.5000006, 0.5000132, 0.5000007, 0.4999987
          , 0.4999919, 0.4999988, 0.4999787, 0.5000002, 0.4999988, 0.5000012
          }
        , { 0.5390656, 0.9482602, 0.5000064, 0.4999847, 0.5, 0.4999973
          , 0.4999913, 0.5000008, 0.5000041, 0.4999999, 0.4999489, 0.4999959
          }
        , { 0.003700425, 0.6277113, 0.5000027, 0.5000034, 0.5000041, 0.4999998
          , 0.4999981, 0.500001, 0.4999983, 0.4999999, 0.4999992, 0.4999965
          }
        , { 0.1875832, 0.5725635, 0.5000001, 0.4999864, 0.4999976, 0.5000002
          , 0.4999992, 0.4999985, 0.5000099, 0.5000017, 0.4999974, 0.4999955
          }
        , { 0.1784605, 0.9948144, 0.5000047, 0.4999988, 0.4999988, 0.4999995
          , 0.5000036, 0.5000016, 0.5000002, 0.499995, 0.4999989, 0.4999979
          }
        , { 0.9961024, 0.4509059, 0.499993, 0.5000063, 0.4999967, 0.4999993
          , 0.5000032, 0.5000002, 0.5000009, 0.4999988, 0.5000002, 0.5000032
          }
        , { 0.3614302, 0.3871945, 0.500003, 0.5000064, 0.5000007, 0.5000008
          , 0.4999976, 0.4999991, 0.4999999, 0.5000045, 0.5000004, 0.5000108
          }
        , { 0.4134784, 0.1412858, 0.5000036, 0.5000081, 0.5000003, 0.4999978
          , 0.500002, 0.4999993, 0.4999986, 0.4999985, 0.4999991, 0.4999996
          }
        , { 0.2321196, 0.4835328, 0.4999999, 0.5000218, 0.4999994, 0.5000019
          , 0.5000001, 0.4999996, 0.4999987, 0.4999995, 0.4999936, 0.4999925
          }
        , { 0.4058323, 0.3871945, 0.4999915, 0.5000064, 0.5000007, 0.4999987
          , 0.5000006, 0.4999995, 0.4999996, 0.4999985, 0.5000004, 0.499996
          }
        , { 0.2407365, 0.8867069, 0.5000001, 0.5000016, 0.5000029, 0.4999978
          , 0.499992, 0.4999995, 0.499999, 0.4999999, 0.5000001, 0.5000011
          }
        , { 0.0007756373, 0.9861591, 0.5000025, 0.5000019, 0.5000005, 0.4999953
          , 0.5000027, 0.499998, 0.500003, 0.4999956, 0.5000002, 0.5000018
          }
        , { 0.4341216, 0.5990706, 0.5000124, 0.4999935, 0.5000021, 0.4999972
          , 0.4999933, 0.5000006, 0.4999999, 0.4999998, 0.5000015, 0.5000001
          }
        , { 0.2898909, 0.1542307, 0.4999996, 0.5000031, 0.4999997, 0.5000006
          , 0.5000075, 0.4999995, 0.4999939, 0.4999979, 0.5000003, 0.4999968
          }
        , { 0.001523307, 0.4163411, 0.500008, 0.5000168, 0.4999989, 0.5
          , 0.4999969, 0.5000021, 0.5000009, 0.4999979, 0.5000004, 0.499998
          }
        , { 0.4575707, 0.9499119, 0.4999999, 0.5000033, 0.5000009, 0.4999986
          , 0.5000009, 0.499999, 0.4999931, 0.5, 0.4999997, 0.4999927
          }
        , { 0.3913925, 0.6113931, 0.4999995, 0.5000032, 0.5000095, 0.5000029
          , 0.5000036, 0.4999994, 0.4999868, 0.5000124, 0.4999997, 0.4999981
          }
        , { 0.003700425, 0.6837413, 0.5000037, 0.5000075, 0.5000006, 0.4999999
          , 0.4999982, 0.4999959, 0.5000046, 0.4999995, 0.5000005, 0.4999983
          }
        , { 0.4721878, 0.5591866, 0.5000074, 0.4999989, 0.5000011, 0.500001
          , 0.5000026, 0.4999995, 0.5000023, 0.500001, 0.5000004, 0.5000011
          }
        , { 0.566693, 0.7757464, 0.5000021, 0.4999868, 0.4999988, 0.4999997
          , 0.4999909, 0.5000003, 0.5000171, 0.5000055, 0.5000059, 0.4999963
          }
        , { 0.2410363, 0.4411332, 0.5000034, 0.5000137, 0.499999, 0.5000023
          , 0.499991, 0.5000006, 0.4999919, 0.500001, 0.4999981, 0.5000006
          }
        , { 0.3614302, 0.6219518, 0.5000019, 0.5000012, 0.5000022, 0.5000014
          , 0.4999917, 0.4999994, 0.5000008, 0.4999966, 0.500003, 0.5000006
          }
        , { 0.3614302, 0.8040288, 0.4999989, 0.4999809, 0.4999997, 0.4999933
          , 0.5, 0.4999995, 0.5000018, 0.5000041, 0.5000004, 0.4999899
          }
        , { 0.2321196, 0.5248772, 0.500011, 0.4999944, 0.5000017, 0.5000002
          , 0.4999848, 0.499999, 0.4999995, 0.4999973, 0.4999986, 0.4999977
          }
        , { 0.3862198, 0.9702425, 0.5000071, 0.5000066, 0.5, 0.5000007
          , 0.4999986, 0.4999994, 0.5000053, 0.5000084, 0.4999997, 0.5000042
          }
        , { 0.1979618, 0.3885722, 0.5000003, 0.4999952, 0.4999987, 0.4999979
          , 0.499998, 0.4999986, 0.4999999, 0.4999992, 0.5000022, 0.4999929
          }
        , { 0.2554002, 0.3340926, 0.4999986, 0.4999961, 0.4999997, 0.5000032
          , 0.4999887, 0.4999985, 0.5000006, 0.4999973, 0.4999974, 0.5000042
          }
        , { 0.3175584, 0.5813503, 0.4999974, 0.5000146, 0.5000029, 0.4999995
          , 0.500012, 0.4999958, 0.4999974, 0.4999975, 0.4999984, 0.5
          }
        , { 0.4895771, 0.1646748, 0.4999998, 0.4999965, 0.5000026, 0.4999943
          , 0.5000085, 0.5000005, 0.4999999, 0.5000029, 0.4999994, 0.4999965
          }
        , { 0.4738839, 0.4459282, 0.4999966, 0.5000347, 0.4999976, 0.5000019
          , 0.5000033, 0.5000004, 0.4999946, 0.5000004, 0.5000018, 0.4999975
          }
        , { 0.5285127, 0.4938006, 0.5000067, 0.4999994, 0.5000017, 0.5000001
          , 0.5000131, 0.4999984, 0.4999972, 0.4999992, 0.500001, 0.5000012
          }
        , { 0.4575707, 0.961655, 0.4999999, 0.5000033, 0.5000009, 0.4999986
          , 0.5000009, 0.499999, 0.4999931, 0.5, 0.4999997, 0.4999927
          }
        , { 0.1419077, 0.3885722, 0.5000003, 0.4999952, 0.4999965, 0.5000009
          , 0.5000038, 0.499999, 0.4999999, 0.4999994, 0.4999982, 0.4999913
          }
        , { 0.3487403, 0.5000447, 0.5000039, 0.499988, 0.5000018, 0.4999994
          , 0.5000087, 0.5000008, 0.5000005, 0.5000014, 0.5000067, 0.5000039
          }
        , { 0.2321196, 0.5990706, 0.5000058, 0.4999758, 0.4999995, 0.4999984
          , 0.5000026, 0.4999998, 0.4999991, 0.4999995, 0.5000007, 0.500002
          }
        , { 0.497746, 0.9878541, 0.5, 0.4999946, 0.5000019, 0.5000005
          , 0.4999914, 0.5000002, 0.5000005, 0.5000001, 0.5000009, 0.4999869
          }
        , { 0.3517671, 0.4509059, 0.499993, 0.5000063, 0.4999967, 0.4999993
          , 0.5000032, 0.5000002, 0.5000009, 0.4999988, 0.5000002, 0.5000032
          }
        , { 0.5399802, 0.0835531, 0.5000028, 0.5000085, 0.5000001, 0.4999997
          , 0.5000123, 0.4999996, 0.499999, 0.4999995, 0.4999986, 0.5000009
          }
        , { 0.2392274, 0.5613562, 0.5000039, 0.49998, 0.4999996, 0.4999955
          , 0.4999949, 0.5000037, 0.5000005, 0.5000007, 0.5000042, 0.5000003
          }
        , { 0.3876419, 0.4737351, 0.500004, 0.5000109, 0.5000012, 0.5000009
          , 0.4999968, 0.5, 0.4999996, 0.5000004, 0.4999989, 0.5000057
          }
        , { 0.1391944, 0.3340926, 0.4999986, 0.5000086, 0.4999977, 0.5000032
          , 0.4999887, 0.4999985, 0.5000006, 0.4999973, 0.4999974, 0.5000007
          }
        , { 0.3243061, 0.6362998, 0.4999948, 0.4999917, 0.5000001, 0.4999974
          , 0.5000025, 0.4999971, 0.4999944, 0.5, 0.4999999, 0.5000039
          }
        , { 0.2407365, 0.4067599, 0.5000047, 0.499998, 0.4999982, 0.5000054
          , 0.4999998, 0.4999995, 0.4999991, 0.5000031, 0.5000001, 0.499999
          }
        , { 0.2898909, 0.6455714, 0.4999998, 0.5000079, 0.4999997, 0.4999967
          , 0.5000025, 0.5000022, 0.5000454, 0.4999999, 0.5000003, 0.5000014
          }
        , { 0.3487403, 0.01438102, 0.499997, 0.5000062, 0.5000019, 0.4999976
          , 0.5000031, 0.5000008, 0.5000005, 0.5000061, 0.4999984, 0.5000025
          }
        , { 0.1961065, 0.612891, 0.5000057, 0.499991, 0.4999914, 0.5000006
          , 0.4999988, 0.4999987, 0.5000182, 0.4999984, 0.4999997, 0.4999988
          }
        , { 0.3311452, 0.3643984, 0.5000044, 0.5000071, 0.5000004, 0.5000006
          , 0.5000111, 0.4999999, 0.5000044, 0.4999964, 0.4999997, 0.5000033
          }
        , { 0.007903374, 0.3198543, 0.5000008, 0.4999976, 0.5000008, 0.5000003
          , 0.5000065, 0.5000004, 0.5000031, 0.4999971, 0.5000007, 0.4999997
          }
        , { 0.4224191, 0.9979207, 0.5000009, 0.4999796, 0.5, 0.4999991
          , 0.5000101, 0.4999989, 0.500005, 0.5000048, 0.4999992, 0.4999999
          }
        , { 0.2898909, 0.3526097, 0.4999993, 0.5000079, 0.4999997, 0.4999967
          , 0.5000025, 0.5000022, 0.4999973, 0.5000004, 0.5000003, 0.4999958
          }
        , { 0.340478, 0.9277795, 0.5000017, 0.5000034, 0.5000012, 0.4999965
          , 0.4999991, 0.5000007, 0.5000072, 0.4999982, 0.5000036, 0.4999986
          }
        , { 0.24943, 0.6599242, 0.5000016, 0.4999912, 0.4999989, 0.499996
          , 0.4999992, 0.4999998, 0.5000078, 0.4999992, 0.500001, 0.4999981
          }
        };
    double yy [NOBJ];
    size_t sz = sizeof (xx) / (sizeof (double) * DIM);
    for (i=0; i<sz; i++) {
        double s = 0;
        f (xx [i], DIM, yy, NOBJ);
        printf ("G: %e\n", g (xx [i] + DIM - K, K));
        for (j=0; j<NOBJ; j++) {
            printf ("F %d %e\n", j, yy [j]);
            s += yy [j];
        }
        printf ("\ns: %e\n", s);
    }
}
#endif /* DEBUG_EVAL */
